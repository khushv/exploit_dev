import re
from sys import argv

good = ['\x01', '\x02', '\x03', '\x04', '\x05', '\x06', '\x07', '\x08', '\t', '\x0b', '\x0c', '\x0e', '\x0f', '\x10', '\x11', '\x12', '\x13', '\x14', '\x15', '\x16', '\x17', '\x18', '\x19', '\x1a', '\x1b', '\x1c', '\x1d', '\x1e', '\x1f', ' ', '!', '"', '#', '$', '%', '&', "'", '(', ')', '*', '+', ',', '-', '.', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ';', '<', '=', '>', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '[', '\\', ']', '^', '_', '`', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '{', '|', '}', '~', '\x7f']


good = ['\xae',
 '\xfa',
 '\xc3',
 '\xc4',
 '\xd8',
 '\xc2',
 '\xd6',
 '\xd7',
 '\xd4',
 '\xd5',
 '\xd2',
 '\xc1',
 '\xd0',
 '\xd1',
 '$',
 '%',
 '&',
 "'",
 ' ',
 '!',
 '"',
 '#',
 '\xc7',
 '(',
 ')',
 '\xc6',
 '\xfb',
 '\xcc',
 '\xc5',
 '^',
 ']',
 '_',
 'Z',
 '\xca',
 '\\',
 '[',
 '\xdf',
 '\xf3',
 '\xdd',
 '\xde',
 '\xdb',
 '\xdc',
 '\xfc',
 '\xcf',
 '\xcd',
 '\xb9',
 'Y',
 'X',
 'U',
 'T',
 'W',
 'V',
 'Q',
 'P',
 'S',
 'R',
 '-',
 '.',
 '/',
 '*',
 '+',
 ',',
 '\xee',
 '\xed',
 '\xfe',
 '\xd9',
 '\xea',
 '\xec',
 '\xeb',
 '\xb4',
 '\xb5',
 '\x88',
 '\x89',
 '\xb0',
 '\xb1',
 '\xb2',
 '\xb3',
 '\x82',
 '\x83',
 '\x80',
 '\x81',
 '\x86',
 '\x87',
 '\x84',
 '\x85',
 '\x02',
 '\x03',
 '\x01',
 '\x06',
 '\x07',
 '\x04',
 '\x05',
 '\xff',
 '\x08',
 '\t',
 '\xd3',
 '<',
 ';',
 ':',
 '?',
 '>',
 '=',
 '\xbd',
 '\xbe',
 '\xbf',
 '\xba',
 '\xbb',
 '\xbc',
 '\x8b',
 '\x8c',
 '\x8a',
 '\x8f',
 '\x8d',
 '\x8e',
 '\xe9',
 '\xe8',
 '\xe5',
 '\xe4',
 '\xe7',
 '\xe6',
 '\xe1',
 '\xe0',
 '\xe3',
 '\xe2',
 '\xa1',
 '9',
 '8',
 '\xa0',
 '3',
 '2',
 '1',
 '0',
 '7',
 '6',
 '5',
 '4',
 '\x0b',
 '\x0c',
 '\x0f',
 '\x0e',
 '\xa5',
 '\xa4',
 '\xf0',
 '\xb8',
 '\xa7',
 '\xf1',
 '\x9a',
 '\xcb',
 '\x9c',
 '\x9b',
 '\x9e',
 '\x9d',
 '\xce',
 '\x9f',
 '`',
 'a',
 'b',
 'c',
 'd',
 'e',
 'f',
 'g',
 'h',
 'i',
 '\xad',
 '\xa3',
 '\xf6',
 '\xf5',
 '\xf7',
 '\x1a',
 '\x1c',
 '\x1b',
 '\x1e',
 '\x1d',
 '\x1f',
 '\xa2',
 'j',
 'k',
 'l',
 'm',
 'n',
 'o',
 '\xf4',
 '\x99',
 '\x98',
 '\xc9',
 '\xc8',
 '\x91',
 '\x90',
 '\x93',
 '\x92',
 '\x95',
 '\x94',
 '\x97',
 '\x96',
 '\x11',
 '\x10',
 '\x13',
 '\x12',
 '\x15',
 '\x14',
 '\x17',
 '\x16',
 '\x19',
 '\x18',
 '\xb6',
 '\xb7',
 '\xaa',
 '\x7f',
 '~',
 '}',
 '|',
 '{',
 'z',
 '\xaf',
 '\xf8',
 '\xf9',
 '\xc0',
 '\xef',
 'H',
 'I',
 'F',
 'G',
 'D',
 'E',
 'B',
 'C',
 '@',
 'A',
 '\xf2',
 '\xa6',
 '\xac',
 '\xfd',
 'w',
 'v',
 'u',
 't',
 's',
 'r',
 'q',
 'p',
 '\xa9',
 '\xa8',
 '\xda',
 '\xab',
 'y',
 'x',
 'O',
 'M',
 'N',
 'K',
 'L',
 'J']



lookup = {'00': '\x00',
 '01': '\x01',
 '02': '\x02',
 '03': '\x03',
 '04': '\x04',
 '05': '\x05',
 '06': '\x06',
 '07': '\x07',
 '08': '\x08',
 '09': '\t',
 '0a': '\n',
 '0b': '\x0b',
 '0c': '\x0c',
 '0d': '\r',
 '0e': '\x0e',
 '0f': '\x0f',
 '10': '\x10',
 '11': '\x11',
 '12': '\x12',
 '13': '\x13',
 '14': '\x14',
 '15': '\x15',
 '16': '\x16',
 '17': '\x17',
 '18': '\x18',
 '19': '\x19',
 '1a': '\x1a',
 '1b': '\x1b',
 '1c': '\x1c',
 '1d': '\x1d',
 '1e': '\x1e',
 '1f': '\x1f',
 '20': ' ',
 '21': '!',
 '22': '"',
 '23': '#',
 '24': '$',
 '25': '%',
 '26': '&',
 '27': "'",
 '28': '(',
 '29': ')',
 '2a': '*',
 '2b': '+',
 '2c': ',',
 '2d': '-',
 '2e': '.',
 '2f': '/',
 '30': '0',
 '31': '1',
 '32': '2',
 '33': '3',
 '34': '4',
 '35': '5',
 '36': '6',
 '37': '7',
 '38': '8',
 '39': '9',
 '3a': ':',
 '3b': ';',
 '3c': '<',
 '3d': '=',
 '3e': '>',
 '3f': '?',
 '40': '@',
 '41': 'A',
 '42': 'B',
 '43': 'C',
 '44': 'D',
 '45': 'E',
 '46': 'F',
 '47': 'G',
 '48': 'H',
 '49': 'I',
 '4a': 'J',
 '4b': 'K',
 '4c': 'L',
 '4d': 'M',
 '4e': 'N',
 '4f': 'O',
 '50': 'P',
 '51': 'Q',
 '52': 'R',
 '53': 'S',
 '54': 'T',
 '55': 'U',
 '56': 'V',
 '57': 'W',
 '58': 'X',
 '59': 'Y',
 '5a': 'Z',
 '5b': '[',
 '5c': '\\',
 '5d': ']',
 '5e': '^',
 '5f': '_',
 '60': '`',
 '61': 'a',
 '62': 'b',
 '63': 'c',
 '64': 'd',
 '65': 'e',
 '66': 'f',
 '67': 'g',
 '68': 'h',
 '69': 'i',
 '6a': 'j',
 '6b': 'k',
 '6c': 'l',
 '6d': 'm',
 '6e': 'n',
 '6f': 'o',
 '70': 'p',
 '71': 'q',
 '72': 'r',
 '73': 's',
 '74': 't',
 '75': 'u',
 '76': 'v',
 '77': 'w',
 '78': 'x',
 '79': 'y',
 '7a': 'z',
 '7b': '{',
 '7c': '|',
 '7d': '}',
 '7e': '~',
 '7f': '\x7f',
 '80': '\x80',
 '81': '\x81',
 '82': '\x82',
 '83': '\x83',
 '84': '\x84',
 '85': '\x85',
 '86': '\x86',
 '87': '\x87',
 '88': '\x88',
 '89': '\x89',
 '8a': '\x8a',
 '8b': '\x8b',
 '8c': '\x8c',
 '8d': '\x8d',
 '8e': '\x8e',
 '8f': '\x8f',
 '90': '\x90',
 '91': '\x91',
 '92': '\x92',
 '93': '\x93',
 '94': '\x94',
 '95': '\x95',
 '96': '\x96',
 '97': '\x97',
 '98': '\x98',
 '99': '\x99',
 '9a': '\x9a',
 '9b': '\x9b',
 '9c': '\x9c',
 '9d': '\x9d',
 '9e': '\x9e',
 '9f': '\x9f',
 'a0': '\xa0',
 'a1': '\xa1',
 'a2': '\xa2',
 'a3': '\xa3',
 'a4': '\xa4',
 'a5': '\xa5',
 'a6': '\xa6',
 'a7': '\xa7',
 'a8': '\xa8',
 'a9': '\xa9',
 'aa': '\xaa',
 'ab': '\xab',
 'ac': '\xac',
 'ad': '\xad',
 'ae': '\xae',
 'af': '\xaf',
 'b0': '\xb0',
 'b1': '\xb1',
 'b2': '\xb2',
 'b3': '\xb3',
 'b4': '\xb4',
 'b5': '\xb5',
 'b6': '\xb6',
 'b7': '\xb7',
 'b8': '\xb8',
 'b9': '\xb9',
 'ba': '\xba',
 'bb': '\xbb',
 'bc': '\xbc',
 'bd': '\xbd',
 'be': '\xbe',
 'bf': '\xbf',
 'c0': '\xc0',
 'c1': '\xc1',
 'c2': '\xc2',
 'c3': '\xc3',
 'c4': '\xc4',
 'c5': '\xc5',
 'c6': '\xc6',
 'c7': '\xc7',
 'c8': '\xc8',
 'c9': '\xc9',
 'ca': '\xca',
 'cb': '\xcb',
 'cc': '\xcc',
 'cd': '\xcd',
 'ce': '\xce',
 'cf': '\xcf',
 'd0': '\xd0',
 'd1': '\xd1',
 'd2': '\xd2',
 'd3': '\xd3',
 'd4': '\xd4',
 'd5': '\xd5',
 'd6': '\xd6',
 'd7': '\xd7',
 'd8': '\xd8',
 'd9': '\xd9',
 'da': '\xda',
 'db': '\xdb',
 'dc': '\xdc',
 'dd': '\xdd',
 'de': '\xde',
 'df': '\xdf',
 'e0': '\xe0',
 'e1': '\xe1',
 'e2': '\xe2',
 'e3': '\xe3',
 'e4': '\xe4',
 'e5': '\xe5',
 'e6': '\xe6',
 'e7': '\xe7',
 'e8': '\xe8',
 'e9': '\xe9',
 'ea': '\xea',
 'eb': '\xeb',
 'ec': '\xec',
 'ed': '\xed',
 'ee': '\xee',
 'ef': '\xef',
 'f0': '\xf0',
 'f1': '\xf1',
 'f2': '\xf2',
 'f3': '\xf3',
 'f4': '\xf4',
 'f5': '\xf5',
 'f6': '\xf6',
 'f7': '\xf7',
 'f8': '\xf8',
 'f9': '\xf9',
 'fa': '\xfa',
 'fb': '\xfb',
 'fc': '\xfc',
 'fd': '\xfd',
 'fe': '\xfe',
 'ff': '\xff'}

find = open(argv[1], 'r')
"""
#TODO arrange to open good.txt and bad.txt files instead of passing as variables
good_file_handle = open(argv[2], 'r')
good = good_file_handle.read`
"""

pattern = "0x[0-9a-fA-F]{8}"

for line in find:
    #import pdb; pdb.set_trace()
    match = re.search(pattern, line)
    if not match:
        continue
    address = match.group(0)[2:]
    split_up = [(address[i:i+2]) for i in range(0, len(address), 2)]
    trans_char = [] 
    for char in split_up:
        char = char.lower() 
        if char in lookup.keys():
            trans_char.append(lookup[char])
        else:
            print("Unrecognised character")
            break
    result = all(item in good for item in trans_char)
    if result:
        print(line)




